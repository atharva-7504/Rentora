<% layout("/layouts/boilerplate.ejs") %>
<style>
    /* SHOW PAGE WRAPPER */
.row {
  margin-top: 32px;
  justify-content: center;
}

/* TITLE */
.row h2 {
  text-align: center;
  margin-bottom: 28px;
  font-weight: 600;
}

/* CARD */
.card {
  margin: 0 auto 24px;
  border-radius: 16px;
  overflow: hidden;
  border: 1px solid #eee;
}

/* IMAGE */
.show-img {
  height: 320px;
  object-fit: cover;
}

/* CARD TEXT */
.card-text {
  font-size: 18px;
  font-weight: 600;
  text-align: center;
}

/* DETAILS LIST */
ul {
  max-width: 600px;
  margin: 0 auto 24px;
  padding: 24px;
  list-style: none;
  background: #fff;
  border-radius: 14px;
  border: 1px solid #eee;
}

ul li {
  font-size: 16px;
  margin-bottom: 10px;
  color: #333;
}

/* ACTIONS */
a[href*="edit"] {
  display: block;
  text-align: center;
  margin-bottom: 12px;
  font-weight: 600;
  text-decoration: none;
  color: #111;
}

form {
  text-align: center;
}

form button {
  padding: 10px 20px;
  border-radius: 10px;
  border: 1px solid #ddd;
  background: #fff;
  font-weight: 600;
  cursor: pointer;
}

form button:hover {
  background: #f5f5f5;
}

/* RESPONSIVE FIXES */
@media (max-width: 768px) {
  .card.col-6 {
    width: 100%;
  }

  .show-img {
    height: 220px;
  }

  ul {
    padding: 18px;
  }
}

</style>
<div class="row">
        <div class="card col-6">
            <img src="<%=listing.image.url %>" class="card-img-top show-img" alt="listing_image">
            <div class="card-body">
                <p class="card-text"><h3><%= listing.title %></h3></p>
            </div>
        </div>
        <ul>
            <li><%= listing.description %></li>
            <li> &#8377;<%= listing.price.toLocaleString("en-IN") %></li>
            <li><%= listing.location %></li>
            <li><%= listing.country %></li>
        </ul>
        <br>
        <a href="/listings/<%=listing._id%>/edit">Edit this Listing</a>
        <form action="/listings/<%=listing._id%>?_method=DELETE" method="POST">
            <button class="btn btn-dark">Delete</button><br><br>
        </form>
        <hr>
        <div class="mb-3 mt-3">
          <h4>Leave a Review</h4>
          <form action="/listings/<%= listing._id%>/reviews" method="POST" class="needs-validation" novalidate>

              <div class="mb-3 mt-3">
                <label for="rating" class="form-label">Rating</label>
                <input type="range" min="1" max="5" id="rating" name="review[rating]" class="form-range" >
              </div>

              <div class="mb-3 mt-3">
                <label for="comment" class="form-label">Comment</label>
                <textarea type="text" id="comment" name="review[comment]" cols="20" rows="5" class="form-control" required></textarea>
                <div class="invalid-feedback">Please add some comments for review</div>
              </div>

              <br>

              <button class="btn btn-outline-dark">Submit</button>            
          </form>
          <hr>
          <h4>All Reviews</h4>
            <% for(review of listing.reviews){ %>
                <div class="card col-5 mb-3 w-50">
                  <div class="card-body">
                    <h5 class="card-title"><%= review.rating %> stars</h5>
                    <p><%= review.comment %></p>
                    <form action="/listings/<%= listing._id %>/reviews/<%= review._id%>?_method=DELETE" method="POST">
                      <button class="btn btn-dark">Delete</button>
                    </form>
                  </div>
                </div>
            <% } %>
        </div>
</div>    