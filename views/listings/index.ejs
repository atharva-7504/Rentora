

<!-- <div id="filters">
  <div class="filter">
    <div><i class="fa-solid fa-fire"></i></div>
    <p>Trending</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-bed"></i></div>
    <p>Rooms</p>
  </div>
    <div class="filter">
    <div><i class="fa-solid fa-mountain-city"></i></div>
    <p>Iconic Cities</p>
  </div>
    <div class="filter">
    <div><i class="fa-solid fa-mountain"></i></div>
    <p>Hill Stations</p>
  </div>
    <div class="filter">
    <div><i class="fa-solid fa-snowflake"></i></div>
    <p>Arctic</p>
  </div>
    <div class="filter">
    <div><i class="fa-solid fa-campground"></i></div>
    <p>Camping</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-dollar-sign"></i></div>
    <p>Luxury</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-person-swimming"></i></div>
    <p>Amazing Pools</p>
  </div>
  <div class="filter">
    <div><i class="fa-regular fa-building"></i></div>
    <p>Apartments</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-cow"></i></div>
    <p>Forest Retreats</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-water"></i></div>
    <p>Lakefront</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-user"></i></div>
    <p>Solo</p>
  </div>
   -->
<% layout("/layouts/boilerplate.ejs") %>

<style>
  :root {
    --accent: #ff385c;
    --text-main: #222222;
    --text-muted: #717171;
  }

  /* --- 1. Cinematic Hero Slider (Intro) --- */
  .hero-slider {
    height: 350px;
    border-radius: 15px;
    overflow: hidden;
    position: relative;
    margin-bottom: 1.5rem;
  }
  .carousel-item { height: 350px; }
  .carousel-item img {
    height: 100%; width: 100%; object-fit: cover;
    filter: brightness(0.7);
    transition: transform 10s ease-in-out;
  }
  .active img { transform: scale(1.1); }

  .hero-overlay {
    position: absolute; inset: 0;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    z-index: 5; color: white; text-align: center;
  }
  #hero-thought { 
    font-size: clamp(1.5rem, 4vw, 2.5rem); font-weight: 700; 
    letter-spacing: -0.5px; transition: opacity 0.5s;
  }

  /* --- 2. Compact Category Navigation (Premium & Minimal) --- */
  .nav-bar-container {
    position: sticky;
    top: 70px;
    background: white;
    z-index: 1000;
    display: flex;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #f0f0f0;
    margin-bottom: 1.5rem;
  }

  #filters {
    display: flex;
    overflow-x: auto;
    scroll-behavior: smooth;
    gap: 2.5rem;
    padding: 10px 15px;
    scrollbar-width: none;
    flex-grow: 1;
    align-items: center;
  }
  #filters::-webkit-scrollbar { display: none; }

  .filter {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-decoration: none;
    color: var(--text-main);
    opacity: 0.6;
    transition: 0.2s ease;
    min-width: fit-content;
  }
  .filter:hover { opacity: 1; color: var(--accent); }
  .filter i { font-size: 1.1rem; margin-bottom: 4px; }
  .filter p { font-size: 0.65rem; font-weight: 700; margin: 0; text-transform: uppercase; }

  .arrow-btn {
    font-size: 1.2rem;
    cursor: pointer;
    color: #000;
    padding: 0 10px;
    opacity: 0.5;
    transition: 0.2s;
    user-select: none;
  }
  .arrow-btn:hover { opacity: 1; transform: scale(1.1); }

  /* TAX TOGGLE - Updated for Mobile Visibility */
  .tax-toggle-box {
    margin-left: 20px;
    padding: 10px 15px;
    border: 1px solid #ddd;
    border-radius: 12px;
    display: flex;
    align-items: center;
    white-space: nowrap;
    background-color: #fff;
  }

  /* --- 3. Listing Grid & Creative Price Badge --- */
  .listing-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 1.5rem;
  }

  .listing-card {
    border: none;
    position: relative;
    transition: 0.3s;
    cursor: pointer; 
  }

  .image-box {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    aspect-ratio: 1/1;
  }
  .image-box img {
    width: 100%; height: 100%; object-fit: cover;
    transition: 0.5s cubic-bezier(0.2, 1, 0.3, 1);
  }
  .listing-card:hover img { transform: scale(1.05); }

  .price-overlay {
    position: absolute; bottom: 10px; left: 10px;
    background: rgba(255, 255, 255, 0.95);
    padding: 4px 10px; border-radius: 6px;
    font-weight: 800; font-size: 0.85rem;
    color: #000; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .heart-icon {
    position: absolute; top: 10px; right: 10px;
    background: none; border: none;
    color: white; font-size: 1.3rem;
    z-index: 5; text-shadow: 0 0 5px rgba(0,0,0,0.5);
    transition: 0.3s;
  }
  .heart-icon.active { color: var(--accent); }

  .card-body .title { font-weight: 700; color: var(--text-main); margin-top: 8px; font-size: 0.9rem; }
  .tax-info { display: none; color: var(--text-muted); font-size: 0.75rem; }

  /* --- 4. Responsiveness --- */
  @media (max-width: 768px) {
    .hero-slider { height: 250px; border-radius: 0; }
    #filters { gap: 1.5rem; padding: 10px 5px; }
    .arrow-btn { display: none; } 
    .listing-grid { grid-template-columns: repeat(auto-fill, minmax(100%, 1fr)); }
    
    /* Small adjustments to make the toggle fit on mobile */
    .tax-toggle-box {
      margin-left: 5px;
      padding: 5px 10px;
      transform: scale(0.85); /* Slightly smaller to prevent overlap */
    }
    .tax-toggle-box label { font-size: 0.55rem; }
  }
</style>

<div id="hero" class="carousel slide hero-slider carousel-fade" data-bs-ride="carousel">
  <div class="hero-overlay">
    <h2 id="hero-thought">Your next chapter awaits.</h2>
    <p class="small opacity-75">Curated stays from sleek apartments to hillside retreats.</p>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="/assets/photo-1618773928121-c32242e63f39.avif" alt="Hotels">
    </div>
    <div class="carousel-item">
      <img src="/assets/photo-1655265171060-21004d02ae3b.avif" alt="Apartments">
    </div>
    <div class="carousel-item">
      <img src="/assets/photo-1566073771259-6a8506099945.jpg" alt="Apartments">
    </div>
  </div>
</div>

<div class="nav-bar-container px-2 px-md-4">
  <span class="arrow-btn" onclick="scrollFilters(-200)">
    <i class="fa-solid fa-chevron-left"></i>
  </span>

  <div id="filters">
    <% const categories = [
      {n: "Trending", i: "fire"}, {n: "Solo", i: "person"}, {n: "Rooms", i: "bed"}, 
      {n: "Iconic Cities", i: "city"}, {n: "Hill Stations", i: "mountain"}, 
      {n: "Arctic", i: "snowflake"}, {n: "Apartments", i: "building"}, 
      {n: "Amazing Pools", i: "water"}, {n: "Camping", i: "tent"}, 
      {n: "Luxury", i: "gem"}, {n: "Lakefront", i: "water-ladder"}, 
      {n: "Forest Retreats", i: "tree"}
    ]; %>
    <% categories.forEach(cat => { %>
      <a href="/listings?category=<%= cat.n %>" class="filter">
        <i class="fa-solid fa-<%= cat.i %>"></i>
        <p><%= cat.n %></p>
      </a>
    <% }) %>
  </div>

  <span class="arrow-btn" onclick="scrollFilters(200)">
    <i class="fa-solid fa-chevron-right"></i>
  </span>

  <div class="tax-toggle-box">
    <div class="form-check form-switch form-check-reverse m-0">
      <input class="form-check-input shadow-none" type="checkbox" role="switch" id="taxSwitch">
      <label class="form-check-label fw-bold small" for="taxSwitch">TAXES</label>
    </div>
  </div>
</div>

<div class="container-fluid px-md-4">
  <div class="listing-grid">
    <% for(let listing of allListings){ %>
      <div class="listing-card">
        <div class="image-box shadow-sm">
          <button class="heart-icon" onclick="this.classList.toggle('active')">
            <i class="fa-solid fa-heart"></i>
          </button>
          
          <a href="/listings/<%=listing._id%>" class="text-decoration-none">
            <img src="<%= listing.image.url %>" alt="listing image">
            <div class="price-overlay">
              &#8377; <%= listing.price.toLocaleString("en-IN") %>
            </div>
          </a>
        </div>
        <div class="card-body py-1">
          <p class="title m-0"><%= listing.title %></p>
          <div class="tax-info">+18% GST Applied</div>
        </div>
      </div>
    <% } %>
  </div>
</div>

<script>
  const thoughts = ["Your next chapter awaits.", "Stay somewhere unique.", "Elevate your journey.", "Luxury in every detail."];
  let thoughtIdx = 0;
  setInterval(() => {
    thoughtIdx = (thoughtIdx + 1) % thoughts.length;
    const el = document.getElementById('hero-thought');
    if(el) {
        el.style.opacity = 0;
        setTimeout(() => {
        el.innerText = thoughts[thoughtIdx];
        el.style.opacity = 1;
        }, 500);
    }
  }, 4500);

  function scrollFilters(val) {
    document.getElementById('filters').scrollBy(val, 0);
  }

  document.getElementById("taxSwitch").addEventListener("click", () => {
    let taxes = document.getElementsByClassName("tax-info");
    for (let t of taxes) {
      t.style.display = (t.style.display !== "block") ? "block" : "none";
    }
  });
</script>